/* empty css             *//* empty css                   */import{A as R}from"./ArtistList.79affc79.js";import{j as T,l as M,aQ as U,aR as A,aS as $,aT as q,aU as N,aC as z,m as V,aV as j,av as O,_ as Y,d as H,s as Q,P as G,o as J,ai as K,a as n,t as c,b as t,u as s,x as _,aw as W,y as x,f as C,F as w,v as D,a2 as X,e as Z,aF as tt,O as st,af as et,ag as at}from"./index.69f64e29.js";/* empty css                        */import"./IconPark.f27efd9e.js";import"./Play.debfb153.js";import"./Like.da450144.js";import"./PauseOne.46a04f47.js";const S=T({id:"singlistDetail",state:()=>({detail:{},creator:{},subscribers:Array(),relatedList:Array(),simiList:[],comments:Array(),songs:Array(),s:32,artistId:0,loading:!1,ordered:!1,router:M()}),actions:{reset(){},setArtistId(e){this.artistId=e},tag(e){this.router.push({name:"songlist",query:{cat:e}})},async getPlayListDetail(e,l){let i=new Date().valueOf();try{let o=await U(e,l,i);if(o.code===200){o.playlist.description!==null&&(o.playlist.description=o.playlist.description.replace(/(\r\n|\n|\r)/gm,"<br />")),console.log("res.playlist",o.playlist),this.detail=o.playlist,this.creator=o.playlist.creator;let p=o.playlist.trackIds,h=1e3,m=[];for(let d=0;d<p.length;d+=h)m.push(p.slice(d,d+h));this.getSongDetail(m)}}catch{}},async getSongDetail(e){this.loading=!0;let l=e[0],i=e[1],o=new Date().valueOf(),p=[],h="",m=[],d="";l.map(u=>{p.push(u.id)}),h=p.join(","),i&&(i.map(u=>{m.push(u.id)}),d=m.join(","));try{if(i){let u=await A(h,o),r=await A(d,o+1),g=u.concat(r);this.songs=this._normalizeSongs(g)}else{let r=await A(h,o);this.songs=this._normalizeSongs(r)}this.loading=!1}catch{}},async getRelatedPlaylist(e){try{let l=await $(e);l.code===200&&(this.relatedList=l.playlists)}catch{}},async getSubscribersPlaylist(e){let l={id:e,limit:28,offset:0};try{let i=await q(l);i.code===200&&(this.subscribers=i.subscribers)}catch{}},async getCommentPlaylist(e){let l={id:e,limit:28,offset:0};try{let i=await N(l);i.code===200&&(i.hotComments.length>0?this.comments=i.hotComments:this.comments=i.comments)}catch{}},_normalizeSongs(e){let l=[];return e.map(i=>{i.id&&l.push(z(i))}),l},openDesc(e,l){V.alert(l,e,{dangerouslyUseHTMLString:!0,closeOnClickModal:!0,customClass:"descBox",showConfirmButton:!1})},async collectArtist(){let e=this.detail.subscribed?2:1,l=this.detail.subscribed?"\u5DF2\u53D6\u6D88\u6536\u85CF":"\u6536\u85CF\u6210\u529F";try{(await j(e,this.artistId)).code===200&&(O({message:l,type:"success"}),setTimeout(()=>{this.getPlayListDetail(this.artistId,100)},300))}catch{}},toDetail(e){this.router.push({name:"songlistDetail",query:{id:e}})},toUser(e){this.router.push({name:"personal",query:{id:e}})},async _initialize(e){await this.getPlayListDetail(e,100),await this.getRelatedPlaylist(e),await this.getSubscribersPlaylist(e),await this.getCommentPlaylist(e)}},getters:{}});const v=e=>(et("data-v-21ad98c8"),e=e(),at(),e),it={class:"playlist-detail container"},lt={class:"left shadow"},ot={class:"top"},rt={class:"avatar"},nt=["src"],ct={class:"info"},dt={class:"title flex-between"},ut=v(()=>t("div",null,null,-1)),_t={class:"user flex items-center flex-row"},ht=["src"],pt={key:0,class:"createTime"},mt={key:0,class:"tag flex-row"},yt=["onClick"],gt={class:"desc"},ft=["innerHTML"],vt=v(()=>t("i",{class:"iconfont niceiconfontyoujiantou-copy-copy-copy-copy"},null,-1)),kt={class:"content"},bt={class:"right"},Ct={class:"like module shadow"},wt=v(()=>t("div",{class:"card-header flex-row"},[t("span",null,"\u559C\u6B22\u8FD9\u4E2A\u6B4C\u5355\u7684\u4EBA")],-1)),Dt={key:0},At=["onClick"],xt=["src","alt","title"],It={key:1,class:"no-data-text",style:{"padding-bottom":"10px"}},Bt={class:"related module shadow"},St=v(()=>t("div",{class:"card-header flex-row"},[t("span",null,"\u76F8\u5173\u63A8\u8350")],-1)),Pt=["onClick"],Ft={class:"avatar"},Lt=["src","alt","title"],Et={class:"info"},Rt=["title"],Tt={class:"comment module shadow"},Mt=v(()=>t("div",{class:"card-header flex-row"},[t("span",null,"\u7CBE\u5F69\u8BC4\u8BBA")],-1)),Ut={key:0},$t=["onClick"],qt=["src","alt","title"],Nt={class:"info"},zt=["onClick"],Vt={key:1,class:"no-data-text",style:{"padding-bottom":"10px"}},jt=H({__name:"index",setup(e){const l=st(),{_initialize:i,toUser:o,toDetail:p,tag:h,openDesc:m,collectArtist:d,setArtistId:u}=S(),{detail:r,creator:g,loading:P,relatedList:F,songs:L,subscribers:I,comments:B,ordered:E}=Q(S());return G(()=>l.query.id,(f,y)=>{console.log("detail.description",r);let k=Number(l.query.id);k&&i(k)}),J(()=>{const f=Number(l.query.id);u(f),f&&i(f)}),(f,y)=>{const k=K;return n(),c("div",it,[t("div",lt,[t("div",ot,[t("div",rt,[t("img",{src:s(r).coverImgUrl+"?param=200y200",alt:""},null,8,nt)]),t("div",ct,[t("div",dt,[t("span",null,_(s(r).name),1),ut]),t("div",_t,[t("div",{class:"avatar",onClick:y[0]||(y[0]=a=>s(o)(s(g).userId))},[t("img",{src:s(g).avatarUrl+"?param=100y100",alt:""},null,8,ht)]),t("p",{class:"nickname",onClick:y[1]||(y[1]=a=>s(o)(s(g).userId))},_(s(g).nickname),1),s(r).createTime?(n(),c("p",pt,_(s(W)(s(r).createTime,"YYYY-MM-DD"))+"\u521B\u5EFA ",1)):x("",!0)]),s(r).tags&&s(r).tags.length>0?(n(),c("div",mt,[C(" \u6807\u7B7E\uFF1A"),(n(!0),c(w,null,D(s(r).tags,a=>(n(),c("a",{key:a,onClick:b=>s(h)(a)},_(a),9,yt))),128))])):x("",!0),t("div",gt,[t("p",{class:"ellipsis-two",innerHTML:s(r).description},null,8,ft),s(r).description&&s(r).description.length>50?(n(),c("span",{key:0,onClick:y[2]||(y[2]=a=>s(m)(s(r).name,s(r).description)),class:"flex-row"},[C("\u5168\u90E8"),vt])):x("",!0)])])]),X((n(),c("div",kt,[Z(R,{songs:s(L),isPerson:!!s(E),onCollectArtist:s(d),subscribed:s(r).subscribed},null,8,["songs","isPerson","onCollectArtist","subscribed"])])),[[k,s(P)]])]),t("div",bt,[t("div",Ct,[wt,s(I).length>0?(n(),c("ul",Dt,[(n(!0),c(w,null,D(s(I),a=>(n(),c("li",{key:a.userId},[t("div",{class:"avatar",onClick:b=>s(o)(a.userId)},[t("img",{src:a.avatarUrl+"?param=150y150",alt:a.nickname,title:a.nickname},null,8,xt)],8,At)]))),128))])):(n(),c("p",It," \u8FD8\u6CA1\u6709\u4EBA\u559C\u6B22 "))]),t("div",Bt,[St,t("ul",null,[(n(!0),c(w,null,D(s(F),a=>(n(),c("li",{key:a.id,onClick:b=>s(p)(a.id)},[t("div",Ft,[t("img",{src:a.coverImgUrl+"?param=150y150",alt:a.nickname,title:a.nickname},null,8,Lt)]),t("div",Et,[t("h2",{class:"ellipsis",title:a.name},_(a.name),9,Rt),t("span",null,[C("By. "),t("small",null,_(a.creator.nickname),1)])])],8,Pt))),128))])]),t("div",Tt,[Mt,s(B).length>0?(n(),c("ul",Ut,[(n(!0),c(w,null,D(s(B),a=>(n(),c("li",{class:"item",key:a.time},[t("div",{class:"avatar",onClick:b=>s(o)(a.user.userId)},[t("img",{src:a.user.avatarUrl+"?param=150y150",alt:a.user.nickname,title:a.user.nickname},null,8,qt)],8,$t),t("div",Nt,[t("h2",{onClick:b=>s(o)(a.user.userId)},[C(_(a.user.nickname),1),t("small",null," \xB7 "+_(s(tt)(a.time)),1)],8,zt),t("p",null,_(a.content),1)])]))),128))])):(n(),c("p",Vt," \u8FD8\u6CA1\u6709\u4EBA\u8BC4\u8BBA "))])])])}}});var Zt=Y(jt,[["__scopeId","data-v-21ad98c8"]]);export{Zt as default};
